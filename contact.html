<!DOCTYPE html>
<!--
Hello i'm Phil Boivin! 
-->
<html lang="en">

<head>

  <meta charset="utf-8">
  <title>Contactez-moi | Philippe Boivin</title>
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <link rel="icon" type="image/png" href="img/icon.png">

  <!-- jQuery -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/2.1.1/jquery.min.js"></script>

  <!-- custom stylesheet-->
  <link href="css/style.css" rel="stylesheet" type="text/css">

</head>



<body>

  <main>
    <section id="content">

    <h1>Contactez-moi</h1>
    <p>Remplissez le formulaire pour me contacter par courriel</p>

    
      <form id="contact-form" method="post">

      <label class="form-control-bee" for="name"></label>
      <input class="form-control-bee" autocomplete="off" type="text" id="name" name="name" placeholder="Your name here">
      <label class="form-control-bee" for="email"></label>
      <input class="form-control-bee" autocomplete="off" type="email" id="email" name="email" placeholder="Your e-mail here">

      <label for="name-input">Nom</label><br>
      <input type="text" id="name-input" placeholder="Votre nom" class="form-control" maxlength="64" required><br>
      
      <label for="email-input">Courriel</label><br>
      <input type="email" id="email-input" placeholder="Votre adresse courriel" class="form-control" maxlength="320" required><br>
      
      <label for="message-input">Message</label><br>
      <textarea id="message-input" rows="5" placeholder="Votre message" class="form-control" maxlength="1024" required></textarea>
     
      <br>
      <button id="submit-button" type="button" onClick="submitToAPI(event)" class="form-submit">Envoyer</button>
      </form>
    
   <div id="messages" class="error"></div>

   </section>
  
</main>
  
<footer></footer>

 
<script> 
  $(function(){
    $("footer").load("footer.html"); 
  });
</script> 


  <!-- Form validation and post -->
  <script>
    function submitToAPI(e) {
       e.preventDefault();
     
            var x = "<span class='redCircle'>x</span>&nbsp;&nbsp;";
            var nameRegex = /[A-Za-z]{1}[A-Za-z]/;

            if ($("#email").val() || $("#name").val()) {
              return;
            }

            if (!nameRegex.test($("#name-input").val())) {
              $("#messages").html(x+"Le nom doit contenir au moins 2 lettres");
              return;
            }

            var emailRegex = /^((([!#$%&'*+\-/=?^_`{|}~\w])|([!#$%&'*+\-/=?^_`{|}~\w][!#$%&'*+\-/=?^_`{|}~\.\w]{0,}[!#$%&'*+\-/=?^_`{|}~\w]))[@]\w+([-.]\w+)*\.\w+([-.]\w+)*)$/;

            if (!emailRegex.test($("#email-input").val())) {
              $("#messages").html(x+"Veuillez entrer une adresse courriel valide");
              return;
            }

            var msgRegex = /[A-Za-z]{3}[A-Za-z]/;

            if (!msgRegex.test($("#message-input").val())) {
              $("#messages").html(x+"Veuillez entrer un message");
              return;
            }

 
       var data = {
          name: $("#name-input").val(),
          email: $("#email-input").val(),
          message : $("#message-input").val()
        };

       $.ajax({
         type: 'POST',
         url : 'https://039fqid0i9.execute-api.us-east-2.amazonaws.com/Prod',
         dataType: 'json',
         crossDomain: 'true',
         contentType: 'application/json',
         data: JSON.stringify(data),
 
         success: function () {
            alert("Message envoyé.");
            document.getElementById("contact-form").reset();
            location.reload();
         },

         error: function () {
            $("#submit-button").attr('disabled', 'disabled');
            $("#submit-button").addClass('form-submit-disabled');// ADD class form-submit-disabled
            $("#messages").html(x+"Désolé, nous éprouvons des difficultés techniques, veuillez essayer plus tard.");
         }});
     }


  </script>
</body>
</html>